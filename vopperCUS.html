<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vopper - Customization</title>


<style>
    /* --- Starfield Background --- */
    #starfield {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        z-index: -1;
        pointer-events: none;
        margin: 0;
        background: radial-gradient(ellipse at center, #0d0d0d 0%, #000 100%);
    }

    /* --- Body --- */
    body {
        background: transparent;
        color: #f0f0f0;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-start;
        margin: 0;
        padding: 40px 20px;
        min-height: 100vh;
        overflow: hidden;
    }

    /* --- Header --- */
    h1 {
        margin-bottom: 40px;
        font-size: 2.5rem;
        color: #49a8d4;
        text-shadow: 0 3px 10px rgba(0, 0, 0, 0.5);
        text-align: center;
    }

    /* --- Labels --- */
    label {
        display: block;
        margin: 15px 0 5px;
        font-weight: 500;
        font-size: 1rem;
        
    }

    /* --- Text inputs and selects --- */
    input[type="text"],
    select {
        display: block;
        margin-bottom: 25px;
        padding: 12px 20px;
       
        border: 1px solid #333;
        background: #1a1a1a;
        color: #fff;
        font-size: 16px;
        width: 250px;
        max-width: 90vw;
        transition: all 0.2s ease;
    }

    input[type="text"]:hover,
    select:hover {
        border-color: #49a8d4;
        box-shadow: 0 0 10px rgba(73, 168, 212, 0.6);
        
    }

    /* --- Color pickers --- */
    input[type="color"] {
        margin-bottom: 25px;
        padding: 0;
        width: 50px;
        height: 50px;
        border: none;
       border-radius: 400px;
        cursor: pointer;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    input[type="color"]:hover {
        transform: scale(1.15);
        box-shadow: 0 0 12px rgba(73, 168, 212, 0.6);
    }

    /* --- Checkbox --- */
    input[type="checkbox"] {
        width: 22px;
        height: 22px;
        cursor: pointer;
        accent-color: #49a8d4;
        margin-top: 5px;
    }

    /* --- Button --- */
    button {
        padding: 12px 30px;
        background: linear-gradient(145deg, #262727, #000000);
        border: none;
        border-radius: 10px;
        color: #fff;
        font-size: 18px;
        font-weight: 600;
        cursor: pointer;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        transition: all 0.3s ease;
        margin-top: 20px;
    }

    button:hover {
        background: linear-gradient(145deg, #282829, #0c0c0c);
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
    }

    button:active {
        transform: translateY(1px);
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    }

    /* --- Canvas --- */
    #myCanvas {
        margin-top: 40px;
        border-radius: 15px;
        background: #111;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
    }

    /* --- Responsive --- */
    @media (max-width: 700px) {
        h1 {
            font-size: 2rem;
        }

        button {
            font-size: 16px;
            padding: 10px 20px;
        }

        input[type="text"],
        select {
            width: 200px;
        }

        #myCanvas {
            width: 90%;
            height: auto;
        }
    }
</style>


</head>

<body>
    <h1>Customize Your Ball</h1>

    <label for="color">Ball Color:</label>
    <input type="color" id="color" value="#ffffff">

    <label for="glow">Glow:</label>
    <input type="checkbox" id="glow" checked>

    <label for="trail">Trail Color:</label>
    <input type="color" id="trail" value="#00f">

    <button id="saveBtn">Save Customization</button>

    <canvas id="myCanvas" width="600" height="200"></canvas>

    <script type="module">
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
        import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";

        // -------------------- FIREBASE CONFIG --------------------
        const firebaseConfig = {
            apiKey: "AIzaSyBXb9OhOEOo4gXNIv2WcCNmXfnm1x7R2EM",
            authDomain: "velox-c39ad.firebaseapp.com",
            projectId: "velox-c39ad",
            storageBucket: "velox-c39ad.appspot.com",
            messagingSenderId: "404832661601",
            appId: "1:404832661601:web:9ad221c8bfb459410bba20",
            measurementId: "G-X8W755KRF6"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth();

        let currentUser = null;

      // -------------------- LOAD CUSTOMIZATION --------------------
async function loadCustomization(uid) {
    if (uid) {
        try {
            const docRef = doc(db, "scores", uid);
            const docSnap = await getDoc(docRef);
            if (docSnap.exists() && docSnap.data().customization) {
                return docSnap.data().customization;
            }
        } catch (err) {
            console.error("Error loading customization:", err);
        }
    }
    // fallback to localStorage
    const local = localStorage.getItem("customization");
    if (local) return JSON.parse(local);

    // fallback to default values
    return { color: "#ffffff", glow: true, trail: "#00f" };
}

// -------------------- SAVE CUSTOMIZATION --------------------
async function saveCustomization(uid, customization) {
    try {
        if (uid) {
            const docRef = doc(db, "scores", uid);
            const docSnap = await getDoc(docRef);
            let existing = {};
            if (docSnap.exists()) existing = docSnap.data();

            // merge new customization into existing data
            await setDoc(docRef, { ...existing, customization }, { merge: true });
        } else {
            // fallback to localStorage
            localStorage.setItem("customization", JSON.stringify(customization));
        }
        // Reload AFTER a small delay to ensure Firestore has saved
        setTimeout(() => location.reload(), 100);
    } catch (err) {
        console.error("Error saving customization:", err);
    }
}

// -------------------- INIT --------------------
onAuthStateChanged(auth, async (user) => {
    currentUser = user;

    const customization = await loadCustomization(user ? user.uid : null);

    // Apply saved customization to UI
    document.getElementById("color").value = customization.color || "#ffffff";
    document.getElementById("glow").checked = customization.glow ?? true;
    document.getElementById("trail").value = customization.trail || "#00f";

    initGame(customization);
});

// -------------------- SAVE BUTTON --------------------
document.getElementById("saveBtn").addEventListener("click", () => {
    const customization = {
        color: document.getElementById("color").value,
        glow: document.getElementById("glow").checked,
        trail: document.getElementById("trail").value
    };
    saveCustomization(currentUser ? currentUser.uid : null, customization);
});


        // -------------------- GAME SETUP --------------------
        const canvas = document.getElementById("myCanvas");
        const pen = canvas.getContext("2d");

        let cameraOffsetY = 0;
        let currentLevel = 1;
        let gameOver = false;
        let gameWon = false;

        const player = {
            x: canvas.width / 2,
            y: canvas.height - 60,
            radius: 20,
            color: "#ffffff",
            glow: true,
            trail: "#00f",
            vy: 0,
            gravity: 0.6,
            jumpPower: 18,
            onGround: false,
            jumpCount: 0,
            maxJumps: 2,
            trailPositions: []
        };

        const moveSpeed = 5;
        let platforms = [];
        let door = { x: canvas.width / 2 - 25, y: -2000, w: 50, h: 80 };

        // -------------------- INIT GAME --------------------
        function initGame(customization) {
            player.color = customization.color || "#ffffff";
            player.glow = customization.glow ?? true;
            player.trail = customization.trail || "#00f";

            // simple ground platform
            platforms = [{ x: 0, y: canvas.height - 30, w: canvas.width, h: 30, color: "#050505" }];

            loop();
        }

        // -------------------- HELPER --------------------
        function clamp(v, min, max) { return Math.max(min, Math.min(max, v)); }

        function hexToRGBA(hex, alpha) {
            const r = parseInt(hex.slice(1, 3), 16);
            const g = parseInt(hex.slice(3, 5), 16);
            const b = parseInt(hex.slice(5, 7), 16);
            return `rgba(${r},${g},${b},${alpha})`;
        }

        // -------------------- UPDATE --------------------
        function update(delta) {
            // basic left/right
            if (keys["a"]) player.x -= moveSpeed * delta;
            if (keys["d"]) player.x += moveSpeed * delta;
            player.x = clamp(player.x, player.radius, canvas.width - player.radius);

            // jump
            if (keys[" "] && player.jumpCount < player.maxJumps) {
                player.vy = -player.jumpPower;
                player.jumpCount++;
                keys[" "] = false;
            }

            // gravity
            player.vy += player.gravity * delta;
            player.y += player.vy * delta;

            // camera follow
            cameraOffsetY = player.y - canvas.height / 2;

            // ground collision
            player.onGround = false;
            for (const plat of platforms) {
                const withinX = player.x + player.radius > plat.x && player.x - player.radius < plat.x + plat.w;
                const comingDown = player.vy >= 0;
                const topHit = player.y + player.radius > plat.y && player.y + player.radius < plat.y + plat.h;
                if (withinX && comingDown && topHit) {
                    player.y = plat.y - player.radius;
                    player.vy = 0;
                    player.onGround = true;
                    player.jumpCount = 0;
                }
            }

            // record trail positions
            const trailLength = 20;
            player.trailPositions.push({ x: player.x, y: player.y });
            if (player.trailPositions.length > trailLength) player.trailPositions.shift();
        }

        // -------------------- RENDER --------------------
        function render() {
            pen.clearRect(0, 0, canvas.width, canvas.height);

            // background
            pen.fillStyle = "#111";
            pen.fillRect(0, 0, canvas.width, canvas.height);

            // trail
            for (let i = 0; i < player.trailPositions.length; i++) {
                const pos = player.trailPositions[i];
                const alpha = (i + 1) / player.trailPositions.length / 2; // fade
                const radius = player.radius * ((i + 1) / player.trailPositions.length * 0.8 + 0.2); // smaller behind
                pen.beginPath();
                pen.arc(pos.x, pos.y - cameraOffsetY, radius, 0, Math.PI * 2);
                pen.fillStyle = hexToRGBA(player.trail, alpha);
                pen.fill();
            }

            // player
            pen.save();
            pen.beginPath();
            pen.arc(player.x, player.y - cameraOffsetY, player.radius, 0, Math.PI * 2);
            if (player.glow) {
                pen.shadowColor = player.color;
                pen.shadowBlur = 20;
            }
            pen.fillStyle = player.color;
            pen.fill();
            pen.restore();
        }

        // -------------------- INPUT --------------------
        const keys = {};
        window.addEventListener("keydown", e => keys[e.key.toLowerCase()] = true);
        window.addEventListener("keyup", e => keys[e.key.toLowerCase()] = false);

        // -------------------- LOOP --------------------
        let lastTime = performance.now();
        function loop(now = performance.now()) {
            const delta = (now - lastTime) / 16.67;
            lastTime = now;

            update(delta);
            render();

            requestAnimationFrame(loop);
        }

        
    </script>



<div class="GoBack" onclick="window.location='vopper.html';"></div>
<style>  .goBack {
    content: '';
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: transparent;
    box-shadow:
        50px 100px white,
        150px 200px white,
        300px 400px white,
        500px 50px white,
        700px 300px white,
        900px 150px white,
        1100px 500px white;
    animation: twinkle 3s infinite alternate;
}

.GoBack {
  position: fixed;
  bottom: 20px;
  left: 20px;
  width: 55px;
  height: 55px;
  border-radius: 50%;
  background: linear-gradient(135deg, #1e1e1e, #2a2a2a);
  box-shadow: 0 0 10px rgba(27, 27, 27, 0.3),
              0 0 20px rgba(42, 43, 43, 0.2) inset;
  border: 2px solid rgba(108, 110, 110, 0.5);
  cursor: pointer;
  transition: all 0.3s ease;
  z-index: 1000; /* stays above other stuff */
}

/* Hover effect */
.GoBack:hover {
  transform: scale(1.1) rotate(-5deg);
  box-shadow: 0 0 20px rgba(232, 235, 235, 0.6),
              0 0 40px rgba(225, 228, 228, 0.4) inset;
  border-color: rgba(221, 223, 223, 0.8);
}

/* Optional: add an arrow inside using CSS */
.GoBack::before {
  content: "←";
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-48%, -50%); /* adjust X a little */
  font-size: 28px;
  color: rgb(235, 238, 238);
  font-family: Arial, sans-serif;
}


</style>




    <script src="stars.js"></script>
    <canvas id="starfield"></canvas>
</body>

</html>